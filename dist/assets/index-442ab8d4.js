import{g as X,i,k as G,r as n,l as J,o as c,a as F,m as Q,c as m,w as l,d as a,F as k,f as p,j as W,R as Y,K as d,t as b,D as S,b as Z,P as v,p as ee,e as te,_ as le}from"./index-04d23bd8.js";import{g as ae,a as oe,u as se}from"./index-5d0b4697.js";const ne="/doctor/assets/auth_example-9b25c4a0.png",T=f=>(ee("data-v-ec8659c6"),f=f(),te(),f),re=T(()=>p("div",null,"实名信息",-1)),ie={class:"tip"},ue=T(()=>p("img",{style:{width:"100%",height:"100%"},src:ne,alt:""},null,-1)),ce=["src"],de=X({__name:"index",setup(f){const w=i([]),h=i(null),I=i({name:[{required:!0,message:"姓名必填",trigger:["change","blur"]},{validator:(s,e,r)=>{/^[\u4e00-\u9fa5]{1,}$/.test(e)?r():r(new Error("请输入正确的中国人姓名"))},trigger:["change","blur"]}],certificatesNo:[{required:!0,message:"身份证号必填",trigger:["change","blur"]},{validator:(s,e,r)=>{/^(1[1-5]|2[1-3]|3[1-7]|4[1-6]|5[0-4]|6[1-5]|71|8[1-2])\d{4}(18|19|20)\d{2}(0[1-9]|1[0-2])(0[1-9]|1\d|2\d|3[01])\d{3}[\dXx]$/.test(e)?r():r(new Error("请输入正确的身份证号"))},trigger:["change","blur"]}],certificatesUrl:[{required:!0,message:"证件照必须上传",trigger:["change","blur"]}],certificatesType:[{required:!0,message:"身份类型必选",trigger:["change","blur"]}]}),t=i({}),g=i(!1),V=async()=>{g.value=!0;const s=await ae();s.code===200&&(t.value=s.data,g.value=!1)},x=i([]),R=async()=>{const s=await oe();s.code===200&&(x.value=s.data)};G(()=>{V(),R()});const E=s=>{s&&s.validate(async(e,r)=>{if(e){const u=await se(t.value);u.code===200?(v.success("认证成功"),V()):v.error(u.message)}else v.error(r[Object.keys(r)[0]][0].message)})},q=()=>{v.warning("最多上传一张照片")},A=(s,e,r)=>{t.value.certificatesUrl=s.data},y=i(!1),B=()=>{y.value=!0},D=()=>{t.value.certificatesUrl=""},N=i(null),L=()=>{t.value={},N.value.clearFiles()};return(s,e)=>{const r=n("el-icon"),u=n("el-descriptions-item"),P=n("el-descriptions"),U=n("el-input"),_=n("el-form-item"),$=n("el-option"),j=n("el-select"),M=n("el-upload"),C=n("el-button"),z=n("el-form"),H=n("el-card"),K=n("el-dialog"),O=J("loading");return c(),F(k,null,[Q((c(),m(H,null,{header:l(()=>[re]),default:l(()=>[p("div",ie,[p("p",null,[a(r,null,{default:l(()=>[a(W(Y))]),_:1}),d("完成实名认证后才能添加就诊人信息，请先实名认证 ")])]),t.value.authStatus===1?(c(),m(P,{key:0,column:1,border:"",style:{margin:"25px 0"},size:"small"},{default:l(()=>[a(u,{align:"center",label:"用户姓名"},{default:l(()=>[d(b(t.value.name),1)]),_:1}),a(u,{align:"center",label:"证件类型"},{default:l(()=>[d(b(t.value.certificatesType==="10"?"身份证":"户口本"),1)]),_:1}),a(u,{align:"center",label:"证件号码"},{default:l(()=>[d(b(t.value.certificatesNo),1)]),_:1})]),_:1})):S("",!0),t.value.authStatus===0?(c(),m(z,{key:1,model:t.value,rules:I.value,ref_key:"formRef",ref:h,style:{margin:"30px auto",width:"60%"},"label-width":"100"},{default:l(()=>[a(_,{label:"用户姓名",prop:"name"},{default:l(()=>[a(U,{modelValue:t.value.name,"onUpdate:modelValue":e[0]||(e[0]=o=>t.value.name=o),placeholder:"请输入用户姓名"},null,8,["modelValue"])]),_:1}),a(_,{label:"证件类型",prop:"certificatesType"},{default:l(()=>[a(j,{modelValue:t.value.certificatesType,"onUpdate:modelValue":e[1]||(e[1]=o=>t.value.certificatesType=o),style:{width:"100%"},placeholder:"请选择证件类型"},{default:l(()=>[(c(!0),F(k,null,Z(x.value,o=>(c(),m($,{key:o.id,value:o.value,label:o.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(_,{label:"证件号码",prop:"certificatesNo"},{default:l(()=>[a(U,{modelValue:t.value.certificatesNo,"onUpdate:modelValue":e[2]||(e[2]=o=>t.value.certificatesNo=o),placeholder:"请输入证件号码"},null,8,["modelValue"])]),_:1}),a(_,{label:"证件上传",prop:"certificatesUrl"},{default:l(()=>[a(M,{ref_key:"uploadRef",ref:N,"file-list":w.value,"onUpdate:fileList":e[3]||(e[3]=o=>w.value=o),limit:1,action:"/api/oss/file/fileUpload?fileHost=userAuah","list-type":"picture-card","on-exceed":q,"on-success":A,"on-preview":B,"on-remove":D},{default:l(()=>[ue]),_:1},8,["file-list"])]),_:1}),a(_,null,{default:l(()=>[a(C,{type:"primary",onClick:e[4]||(e[4]=o=>E(h.value))},{default:l(()=>[d("提交")]),_:1}),a(C,{onClick:L},{default:l(()=>[d("重写")]),_:1})]),_:1})]),_:1},8,["model","rules"])):S("",!0)]),_:1})),[[O,g.value]]),a(K,{modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=o=>y.value=o)},{default:l(()=>[p("img",{style:{width:"100%"},"w-full":"",src:t.value.certificatesUrl,alt:""},null,8,ce)]),_:1},8,["modelValue"])],64)}}});const ve=le(de,[["__scopeId","data-v-ec8659c6"]]);export{ve as default};
