import{f as O,g as i,j as X,o as d,a as F,l as G,c as m,w as l,d as a,F as k,r as s,k as J,e as p,i as K,P as Q,I as c,t as y,B as T,b as W,N as _,_ as Y}from"./index-93eae3cd.js";import{g as Z,a as ee,u as te}from"./index-7754b825.js";const le="/doctor/assets/auth_example-9b25c4a0.png",ae={class:"tip"},oe=["src"],ne=O({__name:"index",setup(se){const b=i([]),w=i(null),R=i({name:[{required:!0,message:"姓名必填",trigger:["change","blur"]},{validator:(n,e,r)=>{/^[\u4e00-\u9fa5]{1,}$/.test(e)?r():r(new Error("请输入正确的中国人姓名"))},trigger:["change","blur"]}],certificatesNo:[{required:!0,message:"身份证号必填",trigger:["change","blur"]},{validator:(n,e,r)=>{/^(1[1-5]|2[1-3]|3[1-7]|4[1-6]|5[0-4]|6[1-5]|71|8[1-2])\d{4}(18|19|20)\d{2}(0[1-9]|1[0-2])(0[1-9]|1\d|2\d|3[01])\d{3}[\dXx]$/.test(e)?r():r(new Error("请输入正确的身份证号"))},trigger:["change","blur"]}],certificatesUrl:[{required:!0,message:"证件照必须上传",trigger:["change","blur"]}],certificatesType:[{required:!0,message:"身份类型必选",trigger:["change","blur"]}]}),t=i({}),v=i(!1),V=async()=>{v.value=!0;const n=await Z();n.code===200&&(t.value=n.data,v.value=!1)},x=i([]),h=async()=>{const n=await ee();n.code===200&&(x.value=n.data)};X(()=>{V(),h()});const B=n=>{n&&n.validate(async(e,r)=>{if(e){const u=await te(t.value);u.code===200?(_.success("认证成功"),V()):_.error(u.message)}else _.error(r[Object.keys(r)[0]][0].message)})},E=()=>{_.warning("最多上传一张照片")},I=(n,e,r)=>{t.value.certificatesUrl=n.data},g=i(!1),S=()=>{g.value=!0},q=()=>{t.value.certificatesUrl=""},N=i(null),A=()=>{t.value={},N.value.clearFiles()};return(n,e)=>{const r=s("el-icon"),u=s("el-descriptions-item"),L=s("el-descriptions"),U=s("el-input"),f=s("el-form-item"),D=s("el-option"),P=s("el-select"),$=s("el-upload"),C=s("el-button"),j=s("el-form"),M=s("el-card"),z=s("el-dialog"),H=J("loading");return d(),F(k,null,[G((d(),m(M,null,{header:l(()=>e[6]||(e[6]=[p("div",null,"实名信息",-1)])),default:l(()=>[p("div",ae,[p("p",null,[a(r,null,{default:l(()=>[a(K(Q))]),_:1}),e[7]||(e[7]=c("完成实名认证后才能添加就诊人信息，请先实名认证 "))])]),t.value.authStatus===1?(d(),m(L,{key:0,column:1,border:"",style:{margin:"25px 0"},size:"small"},{default:l(()=>[a(u,{align:"center",label:"用户姓名"},{default:l(()=>[c(y(t.value.name),1)]),_:1}),a(u,{align:"center",label:"证件类型"},{default:l(()=>[c(y(t.value.certificatesType==="10"?"身份证":"户口本"),1)]),_:1}),a(u,{align:"center",label:"证件号码"},{default:l(()=>[c(y(t.value.certificatesNo),1)]),_:1})]),_:1})):T("",!0),t.value.authStatus===0?(d(),m(j,{key:1,model:t.value,rules:R.value,ref_key:"formRef",ref:w,style:{margin:"30px auto",width:"60%"},"label-width":"100"},{default:l(()=>[a(f,{label:"用户姓名",prop:"name"},{default:l(()=>[a(U,{modelValue:t.value.name,"onUpdate:modelValue":e[0]||(e[0]=o=>t.value.name=o),placeholder:"请输入用户姓名"},null,8,["modelValue"])]),_:1}),a(f,{label:"证件类型",prop:"certificatesType"},{default:l(()=>[a(P,{modelValue:t.value.certificatesType,"onUpdate:modelValue":e[1]||(e[1]=o=>t.value.certificatesType=o),style:{width:"100%"},placeholder:"请选择证件类型"},{default:l(()=>[(d(!0),F(k,null,W(x.value,o=>(d(),m(D,{key:o.id,value:o.value,label:o.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(f,{label:"证件号码",prop:"certificatesNo"},{default:l(()=>[a(U,{modelValue:t.value.certificatesNo,"onUpdate:modelValue":e[2]||(e[2]=o=>t.value.certificatesNo=o),placeholder:"请输入证件号码"},null,8,["modelValue"])]),_:1}),a(f,{label:"证件上传",prop:"certificatesUrl"},{default:l(()=>[a($,{ref_key:"uploadRef",ref:N,"file-list":b.value,"onUpdate:fileList":e[3]||(e[3]=o=>b.value=o),limit:1,action:"/api/oss/file/fileUpload?fileHost=userAuah","list-type":"picture-card","on-exceed":E,"on-success":I,"on-preview":S,"on-remove":q},{default:l(()=>e[8]||(e[8]=[p("img",{style:{width:"100%",height:"100%"},src:le,alt:""},null,-1)])),_:1},8,["file-list"])]),_:1}),a(f,null,{default:l(()=>[a(C,{type:"primary",onClick:e[4]||(e[4]=o=>B(w.value))},{default:l(()=>e[9]||(e[9]=[c("提交")])),_:1}),a(C,{onClick:A},{default:l(()=>e[10]||(e[10]=[c("重写")])),_:1})]),_:1})]),_:1},8,["model","rules"])):T("",!0)]),_:1})),[[H,v.value]]),a(z,{modelValue:g.value,"onUpdate:modelValue":e[5]||(e[5]=o=>g.value=o)},{default:l(()=>[p("img",{style:{width:"100%"},"w-full":"",src:t.value.certificatesUrl,alt:""},null,8,oe)]),_:1},8,["modelValue"])],64)}}});const ce=Y(ne,[["__scopeId","data-v-ec8659c6"]]);export{ce as default};
